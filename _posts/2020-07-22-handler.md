---
title: Handler
---

**1. 핸들러(Handler) 란 무엇인가?**<br> 
  핸들러란 무엇이고 왜 필요한 것일까요?
앞서 배웠던 스레드(Thread) 는 사용자에게 보이지 않는 Background 에서 실행 되기 때문에 하나의 프로그램에서 여러가지 작업을 동시에 진행되도록 만들어 주는 유용한 개념이었는데요, 이런 스레드에게도 한계점은 있습니다. 바로 'View 자원들에 직접 접근이 불가' 하다는 점입니다.



분명 스레드는 하나의 프로그램에 정의된 자원을 공유할 수 있다고 했는데 버튼이나 텍스트뷰, 리스트뷰와 같은 뷰 들도 한 프로그램의 자원이라고 할 수 있음에도 왜 이들 뷰 자원에는 접근 할 수 없을까요? 왜 스레드가 뷰 자원에 직접 접근 할 수 없는지 텍스트 뷰를 예로 들어보겠습니다.

![21319135580E1D7B1B](https://user-images.githubusercontent.com/62632095/84233775-f45f8480-ab2d-11ea-961d-01f68fe66ad0.png)

  위 그림과 같이 두개의 스레드(thread) 와 하나의 텍스트 뷰(Text view) 가 있습니다. 각각의 스레드 내부에서 텍스트 뷰를 직접 변화 시키는 코드를 작성한다고 가정해 보겠습니다. 그리고 두 개의 스레드가 동시에 하나의 텍스트 뷰를 변화 시키는 코드를 실행 시킨다면 어떻게 될까요? 텍스트 뷰에는 'a' 가 찍히게 될까요, 'b' 가 찍히게 될까요?



  지금 저희가 고민하고 있듯이 컴퓨터도 마찬가지로 고민하고 있을겁니다. 이러한 문제 때문에 안드로이드에서는 스레드가 뷰 자원에 직접 접근을 할 수 없도록 막아두고 핸들러(Handler) 를 이용해 간접 접근 할 수 있도록 해두었습니다.

**2. 핸들러의 원리**<br>
  그렇다면 핸들러는 여러 스레드가 보내온 요청들을 어떻게 관리 할까요? 아무래도 여러 스레드로 부터 무질서하게 들어오는 요청들을 한번에 정리정돈 시켜주게되면 작업을 받는 텍스트 뷰 입장에서도 편할 수 있겠죠? 핸들러와 스레드 사이의 동작 메커니즘은 간단하게 표현 하자면 다음과 같습니다.

![21372744580E231831](https://user-images.githubusercontent.com/62632095/84233675-bc584180-ab2d-11ea-8828-0dc5608c4992.png)

  우선 스레드는 텍스트를 변경해 달라는 요청을 메세지 형태로 만들어 핸들러에게 전달 하게 됩니다. 다음에 핸들러는 여러 스레드로부터 전달받은 메세지들을 '메세지 큐(Message Queue)' 를 이용해 순차적으로 관리해 줍니다. 마지막으로. 이렇게 순서가 정렬 된 요청들을 순차적으로 처리 함으로써 스레드가 텍스트 뷰에 동시 접근 했을때 어떤 작업을 먼저 처리 해야 할지 컴퓨터가 판단 할 수 있습니다.

**3. 핸들러 구현 개념** <br>
  앞서 설명 드렸듯이 핸들러는 여러 스레드로 부터 전달받은 요청들을 메세지를 이용해 간결하게 처리하게 됩니다. 이 메세지에 어떤 정보를 전달하고 이를 받아 사용하는 지를 구현하는 것이 핸들러 구현 원리라고 할 수 있습니다. 다시 말해, 핸들러 구현의 핵심은 어떤 스레드가 메세지를 전달하게 될 지(Sender), 반대로 어떤 스레드가 메세지를 받게 될지 (Receiver) 를 주의 깊게 관찰해 보아야 합니다. 다음 그림을 살펴 보시면 쉽게 이해 할 수있습니다.



  Sub Thread 들은 Text View 를 변화 시키도록 요청하는 Sender 의 역할을 하게 됩니다.  즉, 이 스레드들은 주로 메세지를 보내는 요소라 할 수 있습니다. 그리고 Main Thread 는 이러한 요청들을 받아 관리하고 적절한 동작을 수행하는 Receiver 의 역할을 하게 됩니다. 쭉 메세지를 받기만 하는 요소가 되는 것이지요.



 이처럼 메세지를 받아 적절한 동작을 수행 할 수 있는곳에 핸들러를 부착해 놓고, 여러 다른 스레드에서는 부착된 핸들러로 메세지를 보내도록 설정하기만 하면 됩니다.
